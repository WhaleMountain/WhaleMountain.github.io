<!doctype html><html><head><meta charset=utf-8><title>Whale Mountain
</title><meta name=viewport id=viewport content="width=device-width,initial-scale=1"><link rel=icon type=image/x-icon href=https://whalem.net/images/wm.png><link rel=apple-touch-icon href=https://whalem.net/images/wm.png><link rel=stylesheet href=https://whalem.net/scss/style.css><link rel=stylesheet href=https://whalem.net/scss/monokai-sublime.min.css><script src=https://whalem.net/js/highlight.min.js></script><link rel=stylesheet href=https://whalem.net/scss/highlight.css><link rel=stylesheet href=https://whalem.net/scss/custom.css><meta name=generator content="Hugo 0.131.0"></head><body><div class=header><div class=site-logo__wrap><div id=site-button><div></div></div><div class=site-logo><a href=https://whalem.net/><img src=https://whalem.net/images/wm.png></a></div></div><div class='site-nav u-font' id=nav-bar><div class=site-nav__wrap><a class=site-nav__el href=/>HOME</a></div><div class=site-nav__wrap><a class=site-nav__el href=/post>POST</a></div><div class=site-nav__wrap><a class=site-nav__el href=/about>ABOUT</a></div><div class=site-nav__wrap><a class=site-nav__el href=/tags/>TAGS</a></div></div></div><div class=main><div class=main-content><div class=main-content__date><h4 id=date>Published on &ensp;2024.08.01 21:48</h4><h4 id=date>Edited on &ensp;&ensp;&ensp;&ensp;2024.08.06 23:01</h4></div><div class=main-content__title><h1 id=title>ページネーションの修正</h1></div><div class=main-content__article><article id=content><p>下記コミットの内容についての記事です。</p><ul><li><a href=https://github.com/WhaleMountain/hugo-theme-yuki/commit/a68896df01a2e32293fe6b0396c81d442667b084>fix pagination</a></li></ul><h2 id=tags画面の修正>tags画面の修正</h2><p><a href=https://whalem.net/tags/>Tags</a> ページを見ていたらテーマを確認したところページネーションがうまくいっていないことを確認。<br>下記の記述になっていました。</p><ul><li>layouts/_default/single.html</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>{{ range .Pages }}
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;index-posts__list&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;l-time&#34;</span>&gt;&lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{.Permalink}}&#34;</span>&gt;{{ .Date.Format &#34;2006.01.02 15:04&#34; }}&lt;/<span style=color:#f92672>a</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;l-title&#34;</span>&gt;&lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{.Permalink}}&#34;</span>&gt;{{ .Title }}&lt;/<span style=color:#f92672>a</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>{{ end }}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;index-paginate&#34;</span>&gt;
</span></span><span style=display:flex><span>    {{ partial &#34;pagination.html&#34; . }}
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>div</span>&gt;
</span></span></code></pre></div><p>単純に <a href=https://gohugo.io/templates/pagination/>Pagination</a> が使われていないのを確認、使うように修正。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span><span style=color:#f92672>- {{ range .Pages }}
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+ {{ range .Paginator.Pages }}
</span></span></span></code></pre></div><h2 id=ページネーションの修正>ページネーションの修正</h2><p>他におかしいところないかと大量に記事を追加して確認するとエラーが。。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>pagination.html:106:28<span style=color:#e6db74>&#34;: execute of template failed at &lt;</span>$pag<span style=color:#e6db74>.Last.Permalink&gt;: can’t evaluate field Permalink in type *page.Pager
</span></span></span></code></pre></div><p><a href=https://gohugo.io/templates/pagination/>Pagination</a> のドキュメントを眺めると <code>.Last</code> はあるけど <code>.Last.Permalink</code> については書かれていない。<br>よく見るとドキュメントに<a href=https://gohugo.io/methods/pager/last/>正しい書き方</a>があるのでそれに修正する。</p><ul><li>layouts/partials/pagination.html</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>&lt;!-- Last page. --&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>- {{ if ne $pag.PageNumber $pag.TotalPages }}
</span></span></span><span style=display:flex><span><span style=color:#f92672>- &lt;li&gt;&lt;a href=&#34;{{ $pag.Last.Permalink }}&#34;&gt;&amp;#62;&amp;#62;&lt;/a&gt;&lt;/li&gt;
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+ {{ with $pag.Last }}
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ &lt;li&gt;&lt;a href=&#34;{{ .URL }}&#34;&gt;&amp;#62;&amp;#62;&lt;/a&gt;&lt;/li&gt;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>{{ end }}
</span></span></code></pre></div><p>あとはドキュメントを見ながら同様に <code>.First</code>、<code>.Prev</code>、<code>.Next</code> を修正する。</p><h2 id=最後に>最後に</h2><p>使用しているテーマ <a href=https://github.com/iCyris/hugo-theme-yuki>hugo-theme-yuki</a> は2020年にリポジトリはアーカイブされています。<br><a href=https://github.com/WhaleMountain/hugo-theme-yuki>フォーク</a>して使っていますが、やっぱりメンテは大変 (数年放置してましたが) ですが勉強になりますね。</p></article></div><div class="main-content__tags u-font"><span><a href=https://whalem.net/tags/2024-08>2024-08</a></span>
<span><a href=https://whalem.net/tags/bugfix>Bugfix</a></span></div></div><div class=main-profile><div class=main-profile__avatar><img src="https://avatars.githubusercontent.com/u/33239408?s=460&amp;u=e42f33454abd96a2add42e436aa64421a0591d00&amp;v=4"></div><div class=main-profile__body><div class=main-profile__author><span>Whale Mountain</span></div><div class=main-profile__description><p>Tofu on fire :)</p></div></div></div><div class=main-line></div><div class=main-pn><a class=previous href=https://whalem.net/post/2024-07/hugo-lastmod/><div class=pn-dec></div><div class=pn-els><div class=pn-el__1>2024.07.30 22:12</div><div class=pn-el__2>記事に更新時間の追加</div></div></a><a class=next href=https://whalem.net/post/2024-08/my-dotfiles/><div class=pn-dec></div><div class=pn-els><div class=pn-el__1>2024.08.06 22:18</div><div class=pn-el__2>こだわりのないdotfiles</div></div></a></div></div><div class=footer><div class=copyright-wrap><p class="copyright u-font">© 2021 Whale Mountain. Theme yuki. Powered by Hugo.</p></div></div></body><script src=https://whalem.net/js/page.js></script><script>hljs.initHighlightingOnLoad()</script>