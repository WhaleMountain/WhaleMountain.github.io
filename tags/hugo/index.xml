<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Hugo on Whale Mountain</title><link>https://whalem.net/tags/hugo/</link><description>Recent content in Hugo on Whale Mountain</description><generator>Hugo</generator><language>jp</language><copyright>© 2021 Whale Mountain. Theme yuki. Powered by Hugo.</copyright><lastBuildDate>Mon, 12 Aug 2024 22:49:14 +0900</lastBuildDate><atom:link href="https://whalem.net/tags/hugo/index.xml" rel="self" type="application/rss+xml"/><item><title>Highlight.jsのアップデート</title><link>https://whalem.net/post/2024-08/update-highlightjs/</link><pubDate>Mon, 12 Aug 2024 19:38:41 +0900</pubDate><guid>https://whalem.net/post/2024-08/update-highlightjs/</guid><description>下記コミットの内容についての記事です。
update submodule and config.toml update highlightjs リンクの変更 テーマで使用されていた Highlight.js のバージョンが v9.13.1 でした。
脆弱性の報告もあるのでバージョンを上げようと思いました。
参考: highlight.js@9.13.1 vulnerabilities 公式サイトからJSファイルをダウンロードしてファイルを更新してもいいけど、バージョンアップがしやすいようにCDNを利用します。
- &amp;lt;script src=&amp;quot;{{ &amp;quot;js/highlight.min.js&amp;quot; | absURL }}&amp;quot;&amp;gt;&amp;lt;/script&amp;gt; + &amp;lt;script src=&amp;quot;https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/highlight.min.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt; あとは initHighlightingOnLoad が非推奨になっているので、ドキュメント通りに変更する。
Deprecated API - &amp;lt;script&amp;gt;hljs.initHighlightingOnLoad();&amp;lt;/script&amp;gt; + &amp;lt;script&amp;gt;hljs.highlightAll();&amp;lt;/script&amp;gt; エラーの修正 これで終わりかなと思ったらコンソールに下記 Warning が。。
One of your code blocks includes unescaped HTML. This is a potentially serious security risk. https://github.com/highlightjs/highlight.js/wiki/security The element with unescaped HTML: ... 調べてたら強調されているコードを再強調すると Warning が表示されるらしい。
参考: Repeated highlighting of already highlighted code causes &amp;ldquo;One of your code blocks includes unescaped HTML.</description></item><item><title>ページネーションの修正</title><link>https://whalem.net/post/2024-08/fix-theme-pagination/</link><pubDate>Thu, 01 Aug 2024 21:48:27 +0900</pubDate><guid>https://whalem.net/post/2024-08/fix-theme-pagination/</guid><description>下記コミットの内容についての記事です。
fix pagination tags画面の修正 Tags ページを見ていたらテーマを確認したところページネーションがうまくいっていないことを確認。
下記の記述になっていました。
layouts/_default/single.html {{ range .Pages }} &amp;lt;div class=&amp;quot;index-posts__list&amp;quot;&amp;gt; &amp;lt;div class=&amp;quot;l-time&amp;quot;&amp;gt;&amp;lt;a href=&amp;quot;{{.Permalink}}&amp;quot;&amp;gt;{{ .Date.Format &amp;quot;2006.01.02 15:04&amp;quot; }}&amp;lt;/a&amp;gt;&amp;lt;/div&amp;gt; &amp;lt;div class=&amp;quot;l-title&amp;quot;&amp;gt;&amp;lt;a href=&amp;quot;{{.Permalink}}&amp;quot;&amp;gt;{{ .Title }}&amp;lt;/a&amp;gt;&amp;lt;/div&amp;gt; &amp;lt;/div&amp;gt; {{ end }} &amp;lt;div class=&amp;quot;index-paginate&amp;quot;&amp;gt; {{ partial &amp;quot;pagination.html&amp;quot; . }} &amp;lt;/div&amp;gt; 単純に Pagination が使われていないのを確認、使うように修正。
- {{ range .Pages }} + {{ range .Paginator.Pages }} ページネーションの修正 他におかしいところないかと大量に記事を追加して確認するとエラーが。。
pagination.html:106:28&amp;quot;: execute of template failed at &amp;lt;$pag.Last.Permalink&amp;gt;: can’t evaluate field Permalink in type *page.Pager Pagination のドキュメントを眺めると .Last はあるけど .</description></item><item><title>記事に更新時間の追加</title><link>https://whalem.net/post/2024-07/hugo-lastmod/</link><pubDate>Tue, 30 Jul 2024 22:12:49 +0900</pubDate><guid>https://whalem.net/post/2024-07/hugo-lastmod/</guid><description>個人的にブログの公開日と更新日があるとありがたい。なので Hugo のテーマをいじって更新日を表示する。
テンプレートの修正 とりあえず公式サイトを調べると Lastmod が使えそう。
Hugo テーマのテンプレートを操作して Edited on を追加する。
{{ if ne .Date .Lastmod }} Edited on &amp;amp;ensp;&amp;amp;ensp;&amp;amp;ensp;&amp;amp;ensp;{{ .Lastmod.Format &amp;quot;2006.01.02 15:04&amp;quot; }} {{ end }} とりあえず設定されている Date と更新時間が違うなら表示する。あと無理やり &amp;amp;ensp; で幅を調整。
表示形式は Format を参考にする。
補足 GitHub Actions でビルドして Lastmod を取得すると GitHub にプッシュした時間が取得されるので(多分)、必ず更新時間が表示されます。。。</description></item><item><title>久しぶりに更新</title><link>https://whalem.net/post/2024-07/long-time-no-see/</link><pubDate>Sun, 28 Jul 2024 16:55:43 +0900</pubDate><guid>https://whalem.net/post/2024-07/long-time-no-see/</guid><description>久しぶりに更新 全然運用していなかったので、ブログを更新できるか確認していた。
とりあえずやったことのメモ。
Hugoの確認 GitHub Pages に移行したときの Hugo のバージョンは 0.83.0 だったけど、今は 0.129.0 になってた。
とりあえずビルドできるか確認したら、エラーが。。
parse failed: template: _default/list.html:4: function &amp;quot;sanitizeurl&amp;quot; not defined sanitizeurl がないとのことで代わりのもの探したけどぱっと見見つけられないので、一旦削除で対応 (そんなんでいいのか)
baseUrl のシリアライズなので多分問題ないと思いたい。
GitHub Actionsの更新 Yaml ファイルの中身を忘れているけど、まぁ使っているものは色々バージョンは上げとく。
actions/checkout v2 &amp;gt; v4 peaceiris/actions-hugo v2 &amp;gt; v3 peaceiris/actions-gh-pages v3 &amp;gt; v4 あとはDeploy Keyの再設定
GitHub Pages 用のリポジトリに Deploy keys を登録して、Markdown ファイルを置くリポジトリに Repository secrets を設定する。
WhaleMountain.github.io Settings &amp;gt; Deploy kyes に公開鍵を登録 whalem Settings &amp;gt; Secrets and variables &amp;gt; Repository secrets に秘密鍵を登録 鍵は 1Password で管理。あとはブログ更新しなくなったら Deploy keys の登録を削除する。</description></item><item><title>ラズパイで動かしていたWikiをGitHub Pagesに移行した</title><link>https://whalem.net/post/2021-05/migrating-mywiki-to-github-pages/</link><pubDate>Sun, 30 May 2021 18:54:00 +0900</pubDate><guid>https://whalem.net/post/2021-05/migrating-mywiki-to-github-pages/</guid><description>移行 ラズパイのDockerで自分用のWikiを動かしていたが、GitHub Pagesの誘惑に負けたので移行する。
GitHub Pagesの公開用のリポジトリと、ソース用のリポジトリを分けて作成しているが、個人的にこの構成が好きだからで、特に深い意味はありません。
手順 Username.github.io のリポジトリを作成する 上で作成したリポジトリにDeploy Keyを設定する 次にHugoなどの .md ファイルを置くリポジトリを作成する 1で作成したリポジトリにPushするためにSecret Keyを設定する GitHub Actionを設定し終了 ※ 2, 4で設定したKeyはMacOS上でssh-keygenで作成したKeyを設定する。1には公開鍵(.pub)、3には秘密鍵を設定する。
Github Action Hugo公式のHost on GitHubを参考に作成する。
name: github pages on: push: branches: - main # Set a branch to deploy paths: - 'pages/**' pull_request: jobs: deploy: runs-on: ubuntu-20.04 steps: - uses: actions/checkout@v2 with: submodules: true # Fetch Hugo themes (true OR recursive) fetch-depth: 0 # Fetch all history for .GitInfo and .</description></item></channel></rss>